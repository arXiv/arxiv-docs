# Notes about arXiv's TeXLive Version

## Update to TeX Live 2023

*Update 2023-05-22:* arXiv  has updated its submission system to use a plain instance of[TeXLive 2023](http://tug.org/texlive) for [Submission v1.5](../submit_tex.md#newtex). This means if your submission uses any TeX packages not included in the TeX Live 2023 release, you will need to include their style files with your submission.

TeX Live 2023 comes with an updated and improved collection of local add-ons, support for newer font sets, and everything else you'd expect in a standard TeX Live distribution. While there are enhancements, most of the advice provided for previous versions (TL2009, TL2011, TL2016, TL2020) still applies.

The new tree is based on the official TeX Live 2023 release with an
updated tree of local addons. While most documents developed under TeX
Live 2020 will process fine under the new TeX tree we encourage authors
to switch their development environments to the latest TeX Live 2023 (if
you have not done so already).

Please [contact us](https://arxiv.org/support) if there are modules not include in TeX Live 2023 or
our locally maintained tree that you would like to see added. In most
cases you will want to add customized packages to your submission.
Widely used packages may be added to our local tree for the convenience
of large disciplines.

We do not anticipate significant issues for articles developed under TeX 
Live 2023. If you are submitting articles developed under older TeX Live
releases you may experinece some of the issues below. We ran some tests 
against TeX Live 2020 articles to get a sense for common problems 
with older TeX Live releases.

### Common problems with articles prepared using older TeX Live releases
There have been a significant number of changes since arXiv's last TeX Live 2020 update. 
As part of our testing process, we have compiled articles originally developed and submitted 
under TL2020 using the new TL2023 release. 
The primary objective is to identify any potential issues that our 
existing authors may encounter with the new TeX Live 2023 release.

In general terms, 95% of TL2020 articles compile successfuly under TL2023. 
Nearly 35% of recompiled article PDFs are identical or vary by
a single page (often due to date). Nearly 60% of older TL2020 article source 
resulted in changes to multiple page of the resulting TL2023 PDF. 
**If you are submitting source developed under an older TeX Live version
it is very important to review the PDF generated by TL2023.**

Below we detail some of the issues you may encounter.
These may be of interest to authors who might be submitting updated 
source for a new replacement version of an existing article.

### Package changes that cause compilation failures
 
#### biblatex
    The error is caused by changes in LaTeX definitions. The issue has been resolved in biblatex version v3.18b and above. 

    Error:
        ! Package biblatex Error: Patching \MakeUppercase failed.
    Cause:
        Including an old biblatex.sty file with your submission will cause this error.
    Solution:
        Remove old biblatex.sty file from your submission
Also See:
        [StackExchange](https://tex.stackexchange.com/questions/654476/fresh-texlive-2022-install-biblatex-patching-makeuppercase-failed-error)


#### acmart class:
    The class has been updated to require country field.

    Error:
        ! Class acmart Error: No country present for an affiliation.
    
    Cause:
        Changes to acmart class to make country mandatory.
    
    Solution:
        * Add missing country field or
        * Modify acmart behavior to only issue warnings (See below)
Also See:
        [How to make acmart stop complaining about missing country... @ StackExchange](https://tex.stackexchange.com/questions/655620/how-to-make-acmart-stop-complaining-about-missing-country-in-affiliation)


#### Glossaries: 
    The smallcaps option is no longer supported.

    Error: 
        ! Package glossaries Error: obsolete package option `smallcaps' has been removed. Rollback required or use a newer alternative.
    
    Cause:
        The glossories package 'smallcaps' option has been removed. 
    
        '\usepackage[acronym,smallcaps,nowarn,section,nogroupskip,nonumberlist, automake]{glossaries}'
    
        From CHANGES as of v4.50 (2022-10-14):
            - deprecated acronym style package options
           'description', 'footnote', 'smaller', 'smallcaps', 'dua'
            no longer available. Use rollback for backward-compatibiliy.
    
    Solution:
        Find replacement for smallcaps option. 
    
        Use rollback for backward-compatibiliy.

See page 117 of [Glossaries User Manual](http://ctan.uni-altai.ru/macros/latex2e/contrib/glossaries/glossaries-user.pdf).
See complete Change log at [Changes](http://ctan.math.utah.edu/ctan/tex-archive/macros/latex/contrib/glossaries/CHANGES)

#### iau.cls and iau379.cls compatibility issues
    LaTeX kernel changes conflict with the iau.cls and iau379.cls packages. 

    As of now, we are not aware of an updated version of the iau packages that addresses the issue. 
    However, we have obtained a simple fix from the TeX community that allows for successful compilation 
    of articles utilizing the iau.csl and iau379.cls packages with TL2023.

    Error:

        ! Undefined control sequence.
        l.1 \documentclass
        {iau379}
        ?
        ! Emergency stop.
        l.1 

    Cause:
        Package has not been updated to work with latest LaTeX kernel changes.

    Solution: Disallow iau package modifications to the \document macro. 
    The provided patch saves the \document macro definition prior to calling the iau 
    package and then restores the \document definition after the iau package 
    has been loaded.

        \let\Xdocument\document
        \documentclass{iau379}
        \let\document\Xdocument

    Note: The iau packages compile fine under TeX Live 2020. Submitting articles 
          using iau packages to our TeX Live 2023 system will require the above 
          patch until we acquire and install updated versions of these packages.

Also see ["iau.cls will not compile with a basic document @ StackExchange"](https://tex.stackexchange.com/questions/686413/iau-cls-will-not-compile-with-a-basic-document)

#### Runaway arguments

    Some updated commands (\thanks) may generate a Runaway argument error on older TeX source. 

    Error:
        Runaway argument?

    Cause:
        Incorrectly formatted argument.

    Solution:
        Refer to documentation and update note.

More to come...

##### Package changes that result in visual changes to the TL2023 PDF
 
Please report cases where the update causes unexpected changes to the rendering of your article.



## More on package update policies:

arXiv accepts thousands of articles
every month. Our goal is to provide a stable TeX processing system where
we are able to reprocess papers from TeX source at any point in the
future. arXiv maintains all past TeX trees such that existing papers are
processed using the TeX tree in effect when the paper was originally
submitted. This preserves the original presentation (look-and-feel) of
the paper.

This forces arXiv to limit updates to our TeX tree once we move it into
production since thousands of papers depend on the stability of the
current tree. Introducing package updates that change existing papers is
not acceptable. Therefore, once in production, we do not update the TL
release via the tlmgr command. Special exceptions are made in narrow
well defined cases for bug fixes that are critical to a large community
of authors. During the development process the update processed
introduced bugs and broke existing papers more than once so we are
extremely cautious when it comes to updates.

TeX Live Packages: Updating commonly used packages in the main TL2020
distribution is time consuming since we need to guarantee that existing
papers are not adversly impacted by such a change. New packages: Adding
new packages not included in TeX Live is possible by adding the package
to our local tree. Updating existing packages in the distribution or
local tree is difficult. Options for updating existing packages. One
option is to include the modified package with your submission. Another
option, for packages expected to be used by many authors, is to provide
a modified version (that does not conflict with existing packages) that
may be added to our local tree. If you see the need to include a large
package hierarchy with you submission please contact us before including
significant portions of a TeX Live tree.

Our goal is to update our TeX Live distribution every few years. Since
we maintain all previous trees the overhead of frequent updates is
significant. This schedule will depend on the frequency of updates to
TeX Live and the demand for these updates for arXiv submissions.


We realize this is a major upgrade from TeX Live 2016 to 2020. The new
tree contains thousands of improvements and bug fixes over the previous
tree. Users may choose to replace older documents where such updates
will improve the rendering of documents impacted by bugs in the previous
TL2016-based tree.

*If you are replacing a paper with older TeX source that rendered fine
under the previous release we strongly encourage you to carefully
examine your final PDF.*

### Update to TeX Live 2020 [2020-10-01]

*Update 2020-10-01: arXiv updated to TeXLive 2020* arXiv is now running
under [TeXLive 2020](http://tug.org/texlive), with a new, updated and
enhanced tree of local addons and support for newer font sets, and
everything else contained within the standard distribution. As with
previous updates, most of the TL2009/TL2011/TL2016 advice below still applies.

The new tree is based on the official TeX Live 2020 release with an
updated tree of local addons. While most documents developed under TeX
Live 2016 will process fine under the new TeX tree we encourage authors
to switch their development environments to the latest TeX Live 2020 (if
you have not done so already).

TeX Live 2020 expects LaTeX source files to be encoded in UTF-8 by default
and there is no longer a forgiving fall through to UTF-8 encoding. Compilation
without an encoding declaration and with characters outside of the UTF-8
encoding will fail with an error.

Authors have multiple options to resolve the encoding problem. Ideally,
you will determine the correct encoding and add the following line to 
your source:

    \usepackage[encoding name]{inputenc}

Please review the `inputenc.sty` package's 
[documentation](http://mirrors.ctan.org/macros/latex/base/inputenc.pdf) 
to determine the correct options for your source. The second option is to 
add `\UseRawInputEncoding` as the first line of
your source file. Please see 
[Tug News 28](https://www.latex-project.org/news/latex2e-news/ltnews28.pdf)
for more details.

Addons: Many modules not included in the core TeX Live release and
maintained in our local tree have been updated to the most recent
version, so long as the update does not drastically change or break
existing documents. Modules with little or no recent usage have been
dropped from our local tree.

Please contact us if there are modules not include in TeX Live 2020 or
our locally maintained tree that you would like to see added. In most
cases you will want to add customized packages to your submission.
Widely used packages may be added to our local tree for the convenience
of large disciplines.

### Update to TeX Live 2016 [2017-02-09]

TeX Live changes that may impact some arXiv users:

1.  **psfig**: use of psfig to include figures.
    
    The psfig license is 'non-free' which is incompatible with the
    inclusion policies of the TeX Live organization and as such all
    support for psfig has been removed from the TeX Live 2016 release.
    
    From [psfig's CTAN page](https://www.ctan.org/pkg/psfig):
    
    *The psfig package is largely superseded, for various reasons,
    including its non-free licence. For new work, users are strongly
    encouraged to use the LATEX graphics bundle, specifically, either
    the graphicx or even epsfig package. In particular, epsfig, which is
    always to be found in modern distributions, implements a close
    analogue of the syntax of psfig.*
    
    fix: update to modern graphics package for including figures. The
    TeX community recommends using the \\*includegraphics* directive
    from the *graphicx* package which is part of latex-graphics - *The
    LATEX standard graphics* bundle.

Issues currently under investigation:

These issues currently involve packages from the main TL2016
distribution.

1.  tikz: figures with equations do not render properly with *LaTex* yet
    the same TeX source renders fine with *pdfLaTex*.
    
    We are working with TeX community to learn more about this issue.

2.  pdfpages/lscape/revtex4: unwanted page rotation This rotation
    problem was originally attributed to pdfpages but has since been
    attributed to a conflict between lscape and revtex. Recent versions
    of pdfpages now use lscape such that some of our users are
    experiencing unwanted page rotations.
    
    We are working to resolve this issue with the package maintainers.
    
    fix: include older *pre-lscape* version of pdfpages with submission.

3.  cleveref: unresolved citations leave ?? (Ex. 'Eq. (??)') in paper
    instead of citation number.
    
    **2017-04-25 Update:**
    
    Summary: The problem of unresolved citations is due to the load
    order of the cleveref and hyperref packages. The hyperref package
    must be loaded prior to loading cleveref package. arXiv
    automatically includes the hyperref package when it sees the
    \\documentclass \\begin{document} directives. This results in the
    hyperref module getting loaded after cleveref module and since both
    modules redefine low level macros hyperref ends up redefining the
    ones cleveref defined earlier. In the past if the user attempted to
    load the hyperref package they would see option clash errors. These
    issues often resulted in authors disabling the automatic hyperref
    inclusion.
    
    **Solution:** Our TeX processing module has been modified to include
    the hyperref package before the cleveref package. This enforces the
    load order dependency and eliminates unresolved citations. The code
    has also been modified to recognize user included hyperref inclusion
    to eliminate options conflicts.
    
    Original fix: add *\\usepackage{hyperref} before cleveref.*
    
        \usepackage{hyperref}
        \usepackage{cleveref}
    
    Note: You no longer need to explicitly include hyperref package as
    our code now does this automatically before cleveref package.
    
    Old fix: include 00README.XXX file with nohypertex directive.
    
    In the event conflicts are due to system packages included in your
    paper you may still need to turn off our hyperref inclusion.

An incomplete list of common symptoms, errors, and fixes follows:

1. TikZ and PGF graphics packages.
    
    Reports from users indicate there are problems with these packages
    in our older TeX Live 2011 system. We observed improvements to
    graphics in some TeX Live 2011 submissions that were processed under
    the new TeX Live 2016 tree.
    
    Users who experienced issues with these packages may wish to replace
    their documents in order to take advantage of the latest
    enhancements and bug fixes for these packages.
    
    fix: replace document to reprocess with latest versions of these
    packages.

### Update to TeX Live 2011 [2011-12-06]
*Update 2011-12-06: arXiv switched to
[texlive 2011](http://tug.org/texlive/) with a new, updated and enhanced
tree of local addons. Most of the advice below still applies.*

As of 31 December 2009 arXiv is running
[texlive 2009](http://tug.org/texlive/) with a new, updated and enhanced
tree of local addons, for processing all new submissions and
replacements. This represents a significant improvement over the aging
teTeX system but will likely be slightly disruptive initially.
Submitters may have to change some of their (bad) habits, and possibly
adjust some TeX sources.

The good news is that the arXiv installation has been kept very close to
the official texlive-2009 system with very few local customizations and
modifications. Texlive is one of the current comprehensive mainstream
tex systems available for most platforms (and as live DVD). Therefore
authors with up to date TeX system should encounter fewer surprises and
problems

An incomplete list of common symptoms, errors, and fixes
    follows:

1.  [natbib](http://www.ctan.org/tex-archive/macros/latex/contrib/natbib/)
    was updated to version 8.31 [2009/07/16 8.31 (PWD, AO)]. There are
    some incompatibilities with previous version of natbib (arXiv's
    previous version was 7.1 [2003/06/06 7.1 (PWD)]. We recommend to
    adjust sources to use the current version of natbib. If all else
    fails, bundle your version of natbib.sty with your submission.
    
    The typical symptoms are
    
        ! Package natbib Error: Bibliography not compatible with author-year
        citations.
        
        (natbib)                Press <return> to continue in numerical citation
            style.
        
        See the natbib package documentation for explanation.
        Type  H <return>  for immediate help.
         ...
        
        l.125 ...and\NAT@force@numbers{}\NAT@force@numbers
        
        ?
        ! Emergency stop.
    
    fix: The submission must be made compatible with natbib version 8.31

2.  aa.cls (6.1) and natbib.sty (8.3x collide). The symptoms are:
    
        ! LaTeX Error: Command \bibfont already defined.
                       Or name \end... illegal, see p.192 of the manual.
        
        See the LaTeX manual or LaTeX Companion for explanation.
        Type  H <return>  for immediate help.
         ...
        
        l.15 \begin{document}
    
    fix: do not include your own copy of aa.cls (v6.1). arXiv has a
    patched version which avoids the above problem.

3.  Bad size declared in binary blocks of PostScript files (
    %%BeginBinary: .... count ). Symptoms:
    
        dvips: ! premature end of file in binary section
        
        dvips:  expected to see %%EndBinary at end of data; struggling on
        dvips: ! premature end of file in binary section
    
    fix: figure must be corrected
